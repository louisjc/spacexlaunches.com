build:
    box: node:8
    steps:
        - script:
            name: Install dependencies
            code: |
              npm install
        - script:
            name: Generate site
            code: |
              npm run build
              cp -r _site "$WERCKER_OUTPUT_DIR"
        - script:
            name: Copy s3_website.yml
            code: cp s3_website.yml "$WERCKER_OUTPUT_DIR"

deploy:
    box: louisjc/jekyll-s3-uglifyjs
    steps:
        - script:
            name: s3website
            code: |
              echo "s3_id: $AWS_ACCESS_KEY_ID" >> s3_website.yml
              echo "s3_secret: $AWS_SECRET_ACCESS_KEY" >> s3_website.yml
              echo "s3_bucket: $AWS_BUCKET_URL" >> s3_website.yml
              echo N | s3_website cfg apply
              s3_website push
